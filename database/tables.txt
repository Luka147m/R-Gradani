CREATE TABLE IF NOT EXISTS izdavac (
            id TEXT PRIMARY KEY,
            publisher TEXT,
            description TEXT
        );
        
        CREATE TABLE IF NOT EXISTS skup_podataka (
            id TEXT PRIMARY KEY,
            title TEXT,
            refresh_frequency TEXT,
            theme TEXT,
            description TEXT,
            url TEXT,
            state TEXT,
            created TIMESTAMP,
            modified TIMESTAMP,
            isopen BOOLEAN,
            access_rights TEXT,
            license_title TEXT,
            license_url TEXT,
            license_id TEXT,
            publisher_id TEXT REFERENCES izdavac(id),
            tags JSONB
        );
        
        CREATE TABLE IF NOT EXISTS resurs (
            id TEXT PRIMARY KEY,
            skup_id TEXT REFERENCES skup_podataka(id) ON DELETE CASCADE,
            available_through_api BOOLEAN,
            name TEXT,
            description TEXT,
            created TIMESTAMP,
            last_modified TIMESTAMP,
            format TEXT,
            mimetype TEXT,
            state TEXT,
            size INT,
            url TEXT
        );
        
        CREATE TABLE IF NOT EXISTS komentar (
            id BIGINT PRIMARY KEY,
            user_id BIGINT,
            skup_id TEXT REFERENCES skup_podataka(id),
            created TIMESTAMP,
            subject TEXT,
            message TEXT
        );
        
        CREATE TABLE IF NOT EXISTS slika (
            komentar_id BIGINT REFERENCES komentar(id) ON DELETE CASCADE,
            content_hash TEXT,
            original_name TEXT,
            mime_type TEXT,
            created TIMESTAMP,
            PRIMARY KEY(komentar_id, content_hash)
        );
        
        CREATE TABLE IF NOT EXISTS odgovor (
            id SERIAL PRIMARY KEY,
            komentar_id BIGINT REFERENCES komentar(id) ON DELETE CASCADE,
            created TIMESTAMP,
            message JSONB,
	    score float
        );

-- Spajanje psql terminal
psql -h localhost -p 5432 -U postgres -d r-gradani

pg_dump -U postgres -h localhost -p 5432 -s -f r-gradani-schema.sql r-gradani

pg_dump -U postgres -h localhost -p 5432 -F c -b -v -f r-gradani.backup r-gradani
