post:
  tags:
    - Upload
  summary: Upload and import MBZ file
  description: |
    Upload a Moodle Backup (MBZ) file containing forum discussions with dataset references.
    The system will extract the data, fetch dataset information from data.gov.hr API,
    and import everything into the database asynchronously.

    **Process:**
    1. Validates file is .mbz format and under 100MB
    2. Extracts forum discussions from the backup
    3. Identifies dataset URLs in discussion posts
    4. Fetches dataset metadata from data.gov.hr CKAN API
    5. Imports publishers, datasets, resources, and comments into database
    6. Returns a job ID to track progress

  operationId: uploadMbz
  security:
    - BearerAuth: []
  requestBody:
    required: true
    content:
      multipart/form-data:
        schema:
          type: object
          required:
            - file
          properties:
            file:
              type: string
              format: binary
              description: MBZ (Moodle Backup) file to upload
        encoding:
          file:
            contentType: application/zip
  responses:
    '202':
      description: Import started
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
              message:
                type: string
                example: 'Import started'
              jobId:
                type: string
                example: '550e8400-e29b-41d4-a716-446655440000'
    '400':
      description: Bad request - Invalid file
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
          examples:
            noFile:
              value:
                success: false
                error: 'File missing'
    '500':
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: 'Import failed. Please check server logs for details.'
